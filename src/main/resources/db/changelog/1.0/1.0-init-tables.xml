<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd">

    <changeSet id="1.0-init-tables" author="Krzysztof Kwiatkowski">

        <createTable tableName="household">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_HOUSEHOLD_ID"/>
            </column>

            <column name="population"
                    type="INT"/>
            <column name="cost"
                    type="NUMERIC(8,2)"/>
        </createTable>

        <createTable tableName="user">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_USER_ID"/>
            </column>
            <column name="household"
                    type="INT">
                <constraints foreignKeyName="FK_USER_HOUSEHOLD_ID"
                             references="household(id)"/>
            </column>

            <column name="role"
                    type="VARCHAR(16)"/>

            <column name="login"
                    type="VARCHAR(32)"/>
            <column name="password"
                    type="VARCHAR(256)"/>
            <column name="name"
                    type="VARCHAR(64)"/>
            <column name="email"
                    type="VARCHAR(128)"/>
            <column name="registration_date"
                    type="TIMESTAMP"/>
            <column name="last_failed_login"
                    type="TIMESTAMP"/>
        </createTable>

        <!--

        <createTable tableName="household_user">
            <column name="user_id"
                    type="INT">
                <constraints primaryKey="true"
                             primaryKeyName="PK_HOUSEHOLD_USER_USER_ID"
                             foreignKeyName="FK_HOUSEHOLD_USER_USER_ID"
                             references="user(id)"/>
            </column>
            <column name="household_id"
                    type="INT">
                <constraints primaryKey="true"
                             primaryKeyName="PK_HOUSEHOLD_USER_HOUSEHOLD_ID"
                             foreignKeyName="FK_HOUSEHOLD_USER_HOUSEHOLD_ID"
                             references="household(id)"/>
            </column>

            <column name="role"
                    type="VARCHAR(16)"/>
        </createTable>-->

        <createTable tableName="bank">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_BANK_ID"/>
            </column>

            <column name="household"
                    type="INT">
                <constraints foreignKeyName="FK_BANK_HOUSEHOLD_ID"
                             references="household(id)"/>
            </column>

            <column name="name"
                    type="VARCHAR(128)"/>
            <column name="description"
                    type="VARCHAR(512)"/>
        </createTable>

        <createTable tableName="loan">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_LOAN_ID"/>
            </column>
            <column name="user"
                    type="INT">
                <constraints foreignKeyName="FK_LOAN_USER_ID"
                             references="user(id)"/>
            </column>

            <column name="bank"
                    type="INT">
                <constraints foreignKeyName="FK_LOAN_BANK_ID"
                             references="bank(id)"/>
            </column>

            <column name="annual_loan_percentage"
                    type="NUMERIC(3,2)"/>
            <column name="start_date"
                    type="DATE"/>
            <column name="end_date"
                    type="DATE"/>
            <column name="amount"
                    type="NUMERIC(8,2)"/>
            <column name="installment_amount"
                    type="NUMERIC(8,2)"/>
        </createTable>

        <createTable tableName="cashflow">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_CASHFLOW_ID"/>
            </column>
            <column name="user"
                    type="INT">
                <constraints foreignKeyName="FK_CASHFLOW_USER_ID"
                             references="user(id)"/>
            </column>

            <column name="category"
                    type="VARCHAR(16)"/>

            <column name="start_date"
                    type="DATE"/>
            <column name="end_date"
                    type="DATE"/>
            <column name="period"
                    type="INT"/>
            <column name="amount"
                    type="NUMERIC(8,2)"/>
            <column name="description"
                    type="VARCHAR(512)"/>
        </createTable>

        <createTable tableName="category">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_CATEGORY_ID"/>
            </column>
            <column name="household"
                    type="INT">
                <constraints foreignKeyName="FK_CATEGORY_HOUSEHOLD_ID"
                             references="household(id)"/>
            </column>

            <column name="category"
                    type="VARCHAR(64)"/>
            <column name="description"
                    type="VARCHAR(512)"/>
        </createTable>

        <createTable tableName="goal">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_GOAL_ID"/>
            </column>
            <column name="household"
                    type="INT">
                <constraints foreignKeyName="FK_GOAL_HOUSEHOLD_ID"
                             references="household(id)"/>
            </column>

            <column name="amount"
                    type="NUMERIC(8,2)"/>
            <column name="name"
                    type="VARCHAR(64)"/>
            <column name="description"
                    type="VARCHAR(64)"/>
            <column name="priority"
                    type="INT"/>
        </createTable>

        <createTable tableName="goal_category">
            <column name="category_id"
                    type="INT">
                <constraints primaryKeyName="PK_GOAL_CATEGORY_CATEGORY_ID"
                             primaryKey="true"
                             foreignKeyName="FK_GOAL_CATEGORY_CATEGORY_ID"
                             references="category(id)"/>
            </column>
            <column name="goal_id"
                    type="INT">
                <constraints primaryKeyName="PK_GOAL_CATEGORY_GOAL_ID"
                             primaryKey="true"
                             foreignKeyName="FK_GOAL_CATEGORY_GOAL_ID"
                             references="goal(id)"/>
            </column>
        </createTable>

        <createTable tableName="investment">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_INVESTMENT_ID"/>
            </column>
            <column name="user"
                    type="INT">
                <constraints foreignKeyName="FK_INVESTMENT_USER_ID"
                             references="user(id)"/>
            </column>

            <column name="period"
                    type="INT"/>
            <column name="start_date"
                    type="DATE"/>
            <column name="end_date"
                    type="DATE"/>
            <column name="investment_percentage"
                    type="NUMERIC(3,2)"/>
            <column name="amount"
                    type="NUMERIC(8,2)"/>
            <column name="name"
                    type="VARCHAR(64)"/>
        </createTable>

        <createTable tableName="investment_category">
            <column name="category_id"
                    type="INT">
                <constraints primaryKeyName="PK_INVESTMENT_CATEGORY_CATEGORY_ID"
                             primaryKey="true"
                             foreignKeyName="FK_INVESTMENT_CATEGORY_CATEGORY_ID"
                             references="category(id)"/>
            </column>
            <column name="investment_id"
                    type="INT">
                <constraints primaryKeyName="PK_INVESTMENT_CATEGORY_INVESTMENT_ID"
                             primaryKey="true"
                             foreignKeyName="FK_INVESTMENT_CATEGORY_INVESTMENT_ID"
                             references="investment(id)"/>
            </column>
        </createTable>

        <createTable tableName="debt_card">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_DEBT_CARD_ID"/>
            </column>
            <column name="user"
                    type="INT">
                <constraints foreignKeyName="FK_DEBT_CARD_USER_ID"
                             references="user(id)"/>
            </column>

            <column name="bank"
                    type="INT">
                <constraints foreignKeyName="FK_DEBT_CARD_BANK_ID"
                             references="bank(id)"/>
            </column>

            <column name="limit"
                    type="NUMERIC(8,2)"/>
            <column name="balance"
                    type="NUMERIC(8,2)"/>
            <column name="renewal_percentage"
                    type="NUMERIC(3,2)"/>
            <column name="annual_percentage"
                    type="NUMERIC(3,2)"/>
            <column name="name"
                    type="VARCHAR(512)"/>
        </createTable>

        <createTable tableName="vehicle">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_VEHICLE_ID"/>
            </column>

            <column name="user"
                    type="INT">
                <constraints foreignKeyName="FK_VEHICLE_USER_ID"
                             references="user(id)"/>
            </column>

            <column name="name"
                    type="VARCHAR(128)"/>
            <column name="vehicle_tid"
                    type="TIMESTAMP"/>
            <column name="vehicle_lp"
                    type="VARCHAR(64)"/>
        </createTable>

        <createTable tableName="insurance">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_INSURANCE_ID"/>
            </column>
            <column name="user"
                    type="INT">
                <constraints foreignKeyName="FK_INSURANCE_USER_ID"
                             references="user(id)"/>
            </column>

            <column name="vehicle"
                    type="INT">
                <constraints foreignKeyName="FK_INSURANCE_VEHICLE_ID"
                             references="vehicle(id)"/>
            </column>

            <column name="type"
                    type="VARCHAR(16)"/>

            <column name="description"
                    type="VARCHAR(512)"/>
            <column name="period"
                    type="INT"/>
            <column name="cost"
                    type="NUMERIC(8,2)"/>
            <column name="end_date"
                    type="DATE"/>
            <column name="name"
                    type="VARCHAR(64)"/>
        </createTable>

        <createTable tableName="balance">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_BALANCE_ID"/>
            </column>
            <column name="household"
                    type="INT">
                <constraints foreignKeyName="FK_BALANCE_HOUSEHOLD_ID"
                             references="household(id)"/>
            </column>

            <column name="type"
                    type="VARCHAR(16)"/>

            <column name="generation_date"
                    type="DATE"/>
            <column name="burden"
                    type="NUMERIC(8,2)"/>
            <column name="income"
                    type="NUMERIC(8,2)"/>
            <column name="balance"
                    type="NUMERIC(8,2)"/>
        </createTable>

        <createTable tableName="account">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_ACCOUNT_ID"/>
            </column>

            <column name="user"
                    type="INT">
                <constraints foreignKeyName="FK_ACCOUNT_USER_ID"
                             references="user(id)"/>
            </column>
            <column name="bank"
                    type="INT">
                <constraints foreignKeyName="FK_ACCOUNT_BANK_ID"
                             references="bank(id)"/>
            </column>

            <column name="amount"
                    type="NUMERIC(8,2)"/>
        </createTable>

        <createTable tableName="wallet">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_WALLET_ID"/>
            </column>

            <column name="user"
                    type="INT">
                <constraints foreignKeyName="FK_WALLET_USER_ID"
                             references="user(id)"/>
            </column>

            <column name="amount"
                    type="NUMERIC(8,2)"/>
        </createTable>

        <createTable tableName="user_hist">
            <column name="id"
                    type="INT"
                    autoIncrement="true">
                <constraints primaryKey="true"
                             primaryKeyName="PK_USER_HIST_ID"/>
            </column>

            <column name="user_id"
                    type="INT"/>
            <column name="operation"
                    type="VARCHAR(256)"/>
            <column name="operation_date"
                    type="TIMESTAMP"/>

            <column name="household"
                    type="INT">
                <constraints foreignKeyName="FK_USER_HIST_HOUSEHOLD_ID"
                             references="household(id)"/>
            </column>
            <column name="household_old"
                    type="INT">
                <constraints foreignKeyName="FK_USER_HIST_HOUSEHOLD_OLD_ID"
                             references="household(id)"/>
            </column>

            <column name="role"
                    type="VARCHAR(16)"/>
            <column name="login"
                    type="VARCHAR(32)"/>
            <column name="password"
                    type="VARCHAR(256)"/>
            <column name="name"
                    type="VARCHAR(64)"/>
            <column name="email"
                    type="VARCHAR(128)"/>

            <column name="role_old"
                    type="VARCHAR(16)"/>
            <column name="login_old"
                    type="VARCHAR(32)"/>
            <column name="password_old"
                    type="VARCHAR(256)"/>
            <column name="name_old"
                    type="VARCHAR(64)"/>
            <column name="email_old"
                    type="VARCHAR(128)"/>
        </createTable>
    </changeSet>

</databaseChangeLog>